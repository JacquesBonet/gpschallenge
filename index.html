<!DOCTYPE html>
<html>
<head>
    <title>ForeignKey column</title>
    <meta charset="utf-8">
    <link href="./styles/kendo.common.min.css" rel="stylesheet">
    <link href="./styles/kendo.rtl.min.css" rel="stylesheet">
    <link href="./styles/kendo.default.min.css" rel="stylesheet">
    <link href="./styles/examples-offline.css" rel="stylesheet">
    <script src="jquery.min.js"></script>
    <script src="kendo.web.min.js"></script>
</head>
<body>
	<div class="banner">
		<a href="http://windsurfing33.com" target="_blank"><div class="windsurfing33"></div></a>
		<div class="textbanner"></div>
		<a href="http://www.glissup.fr" target="_blank"><div class="glissup"></div></a>
	</div>
	<div id="containgrid" class="k-content">
    <table id="grid" data-bind="source: drivers"></table>
</div>
<script>
	var rowNumber = 0;
	 
	function resetRowNumber(e) {
	    rowNumber = 0;
	}
	 
	function renderNumber(data) {
	    return ++rowNumber;
	}

	function resizeGrid() {
	    var gridElement = $("#grid");
	    var dataArea = gridElement.find(".k-grid-content");
	    var newHeight = gridElement.parent().innerHeight() - 2;
	    var diff = gridElement.innerHeight() - dataArea.innerHeight();
	    gridElement.height(newHeight);
	    dataArea.height(newHeight - diff);
	}

    $(document).ready(function () {

        var gridColumns = [];
        gridColumns.push({ title: "Rank", width: "40px", template: "#= renderNumber(data) #"});
        gridColumns.push({ field: "name", title: "Driver", template: '<a href=\" #: driverUrl # \" target=\"_blank\"> #: name # </a>'});
        gridColumns.push({ field: "speed", title: "Moy", width: "50px", format: "{0:n2}"});
        for (var j = 0; j < 5; j++) {
            gridColumns.push({ field: 'runs[' + j + '].speed', title: 'V(Knot)', width: "50px", format: '{0:n2}'});
            gridColumns.push({ field: 'runs[' + j + '].spot', title: 'Spot', width: "58px", template: '<a href=\" #: runs[' + j + '].maps # \" target=\"_blank\"> #: runs[' + j + '].spot # </a>'});
            gridColumns.push({ field: 'runs[' + j + '].date', title: 'Date', width: "84px", format: '{0:MM/dd/yyyy}'});
        }

        $("#grid").kendoGrid({
            sortable: true,
            resizable: true,
            dataBound:resetRowNumber,
            columns: gridColumns
        });

		$(window).resize(function(){
		    resizeGrid();
		});

        $("#grid").data().kendoGrid.thead.prepend('<tr><td colspan=3></td><td colspan=3 align="center">500 m Run 1</td><td colspan=3 align="center">500 m Run 2</td><td colspan=3 align="center">500 m Run 3</td><td colspan=3 align="center">500 m Run 4</td><td colspan=3 align="center">500 m Run 5</td></tr>');

        $.getJSON("./gpsChallenge.json", function (jsonData) {

            kendo.bind($('#grid'), jsonData);

        });
        $("#grid").data('kendoGrid').dataSource.sort({ field: "speed", dir: "desc" });
        resizeGrid();
    });
</script>
</body>
</html>
